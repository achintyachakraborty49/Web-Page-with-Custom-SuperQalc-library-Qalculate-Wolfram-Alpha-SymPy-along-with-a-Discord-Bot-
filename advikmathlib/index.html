<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Math & Game Hub + Roblox</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Roboto', sans-serif; background: #121212; color: #f5f5f5; margin: 0; padding: 0; }
  .app-container { display: flex; height: 100vh; }
  .sidebar { width: 200px; background: #1f1f1f; display: flex; flex-direction: column; padding: 10px; gap: 10px; }
  .sidebar button { background: #00e0ff; color: #121212; padding: 10px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
  .sidebar button:hover { background: #00ffa0; }
  .main-content { flex: 1; overflow-y: auto; }
  header { text-align: center; padding: 1rem; background: #1f1f1f; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }
  header h1 { margin: 0; color: #00e0ff; }
  main { display: flex; flex-wrap: wrap; justify-content: center; padding: 2rem; gap: 2rem; }
  .card { background: #1e1e1e; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.6); padding: 1.5rem; width: 300px; flex: 1 1 300px; }
  .card h2 { margin-top: 0; color: #00ffa0; }
  input, button, textarea, select { width: 100%; padding: 0.5rem; margin: 0.3rem 0; border-radius: 6px; border: none; outline: none; font-size: 1rem; }
  pre { background: #121212; border: 1px solid #333; border-radius: 8px; padding: 0.5rem; max-height: 200px; overflow-y: auto; }
  .board { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; }
  .board button { font-size: 2rem; background: #222; color: #fff; }
  .section { padding: 0; display: none; }
  .section.active { display: block; }
</style>
</head>
<body>

<div class="app-container">
  <aside class="sidebar">
    <button onclick="showSection('hub')">Math & Game Hub</button>
    <button onclick="showSection('roblox')">Play Roblox</button>
  </aside>

  <div class="main-content">
    <!-- Math & Game Hub Section -->
    <section id="hub" class="section active">
      <header>
        <h1>Math & Game Hub</h1>
      </header>
      <main>
        <!-- CALCULATOR CARD -->
        <div class="card">
          <h2>Calculator</h2>
          <textarea id="calcInput" placeholder="Enter expression"></textarea>
          <select id="calcType">
            <option value="qalc">Qalculate</option>
            <option value="sympy">SymPy</option>
            <option value="super_onefile">SuperQalc Onefile</option>
            <option value="super_tower">SuperQalc Tower</option>
            <option value="wolfram">Wolfram Alpha</option>
          </select>
          <button onclick="calculate()">Compute</button>
          <pre id="calcResult"></pre>
        </div>

        <!-- TIC TAC TOE CARD -->
        <div class="card">
          <h2>Tic Tac Toe (AI)</h2>
          <div class="board" id="tictactoeBoard"></div>
          <pre id="tttStatus"></pre>
          <button onclick="startTicTacToe()">Restart</button>
        </div>

        <!-- CHESS CARD -->
        <div class="card">
          <h2>Chess 1v1</h2>
          <textarea id="chessMove" placeholder="Enter UCI move e2e4"></textarea>
          <button onclick="makeChessMove()">Send Move</button>
          <pre id="chessBoard"></pre>
        </div>

        <!-- SUDOKU CARD -->
        <div class="card">
          <h2>Sudoku</h2>
          <textarea id="sudokuInput" placeholder="Enter Sudoku grid as 81 digits, 0 for empty"></textarea>
          <button onclick="solveSudoku()">Solve</button>
          <pre id="sudokuOutput"></pre>
        </div>
      </main>
    </section>

    <!-- Roblox Section -->
<section id="roblox" class="section">
  <header>
    <h1>Play Roblox</h1>
  </header>
  <main>
    <p>Click below to open Roblox in a new tab:</p>
    <button onclick="window.open('https://www.roblox.com', '_blank')">
      Launch Roblox
    </button>
  </main>
</section>
  </div>
</div>

<script>
function showSection(id) {
  document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* ======= CALCULATOR ======= */
async function calculate() {
  const expr = document.getElementById('calcInput').value;
  const type = document.getElementById('calcType').value;
  let url = "";
  switch(type) {
    case "qalc": url = "/calc/qalc"; break;
    case "sympy": url = "/calc/sympy"; break;
    case "super_onefile": url = "/calc/qalc"; break;
    case "super_tower": url = "/calc/qalc"; break;
    case "wolfram": url = "/calc/wolfram"; break;
    default: url = "/calc/qalc";
  }
  const res = await fetch(url, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ expression: expr })
  });
  const data = await res.json();
  document.getElementById('calcResult').textContent = data.result || data.detail || "No result";
}

/* ======= TIC TAC TOE ======= */
let tttUserId = "user123";
async function startTicTacToe() {
  const res = await fetch("/tictactoe", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ user_id: tttUserId })
  });
  const data = await res.json();
  renderTTT(data.board);
  document.getElementById('tttStatus').textContent = data.message;
}
async function tttMove(pos) {
  const res = await fetch("/tictactoe/move", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ user_id: tttUserId, position: pos + 1 })
  });
  const data = await res.json();
  renderTTT(data.board);
  document.getElementById('tttStatus').textContent = data.message;
}
function renderTTT(boardStr) {
  const boardDiv = document.getElementById('tictactoeBoard');
  boardDiv.innerHTML = '';
  boardStr.split('').forEach((cell, i) => {
    const btn = document.createElement('button');
    btn.textContent = cell;
    btn.onclick = () => tttMove(i);
    boardDiv.appendChild(btn);
  });
}

/* ======= CHESS ======= */
async function makeChessMove() {
  const move = document.getElementById('chessMove').value;
  const res = await fetch("/chess", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      user1_id: "player1",
      user2_id: "player2",
      move: move,
      action: "move"
    })
  });
  const data = await res.json();
  document.getElementById('chessBoard').textContent = data.board || data.message || data.detail;
}

/* ======= SUDOKU ======= */
async function solveSudoku() {
  const grid = document.getElementById('sudokuInput').value;
  const res = await fetch("/sudoku/solve", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ puzzle: grid })
  });
  const data = await res.json();
  document.getElementById('sudokuOutput').textContent =
    data.solution ? data.solution.map(row => row.join(' ')).join('\n') : data.detail;
}

startTicTacToe();
</script>

</body>
</html>
